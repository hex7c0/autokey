/*
 * autokey v1.3.4
 * (c) hex7c0 http://supergiovane.tk/#/autokey
 * Licensed under GPLv3
 */
"use strict";function body(a,b,c){var d;d=Buffer.isBuffer(a)?a:new Buffer(a);var e=[],f=b,g=f.length,h=g;if(c)for(var i=0,j=d.length;j>i;i++)h>0?(e[i]=(d[i]-f.shift())%256,h--):e[i]=(d[i]-e[i-g])%256;else for(var i=0,j=d.length;j>i;i++)h>0?(e[i]=(d[i]+f.shift())%256,h--):e[i]=(d[i]+d[i-g])%256;return new Buffer(e)}function AUTOKEY(a){this.key,this.change(a)}module.exports=function(a){return new AUTOKEY(a)},AUTOKEY.prototype.change=function(a){if(this.key=new Array(a.legth),Array.isArray(a))this.key=a;else{if("string"!=typeof a&&!Buffer.isBuffer(a))throw new Error("Invalid data");for(var a=new Buffer(a),b=0,c=a.length;c>b;b++)this.key[b]=a[b]}},AUTOKEY.prototype.encodeString=function(a,b,c){var d=new Buffer(a,b||"binary");return body(d,this.key.slice(0)).toString(c||"binary")},AUTOKEY.prototype.encodeArray=function(a){for(var b=body(a,this.key.slice(0)),c=new Array(b.length),d=0,e=b.length;e>d;d++)c[d]=b[d];return c},AUTOKEY.prototype.encodeBuffer=function(a){return body(a,this.key.slice(0))},AUTOKEY.prototype.encode=function(a){if("string"==typeof a)return this.encodeString(a);if(Array.isArray(a))return this.encodeArray(a);if(Buffer.isBuffer(a))return this.encodeBuffer(a);throw new Error("Invalid data")},AUTOKEY.prototype.decodeString=function(a,b,c){var d=new Buffer(a,b||"binary");return body(d,this.key.slice(0),!0).toString(c||"binary")},AUTOKEY.prototype.decodeArray=function(a){for(var b=body(a,this.key.slice(0),!0),c=new Array(b.length),d=0,e=b.length;e>d;d++)c[d]=b[d];return c},AUTOKEY.prototype.decodeBuffer=function(a){return body(a,this.key.slice(0),!0)},AUTOKEY.prototype.decode=function(a){if("string"==typeof a)return this.decodeString(a);if(Array.isArray(a))return this.decodeArray(a);if(Buffer.isBuffer(a))return this.decodeBuffer(a);throw new Error("Invalid data")};
